\hypertarget{group__domains__up}{}\section{Unstructured domains}
\label{group__domains__up}\index{Unstructured domains@{Unstructured domains}}


Add and modify unstructured domains to the R\+NA folding grammar.  




\subsection{Detailed Description}
Add and modify unstructured domains to the R\+NA folding grammar. 

This module provides the tools to add and modify unstructured domains to the production rules of the R\+NA folding grammar. Usually this functionality is utilized for incorporating ligand binding to unpaired stretches of an R\+NA.

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000002}{Bug}]Although the additional production rule(s) for unstructured domains as descibed in domains\+\_\+unstructured are always treated as \textquotesingle{}segments possibly bound to one or more ligands\textquotesingle{}, the current implementation requires that at least one ligand is bound. The default implementation already takes care of the required changes, however, upon using callback functions other than the default ones, one has to take care of this fact. Please also note, that this behavior might change in one of the next releases, such that the decomposition schemes as shown above comply with the actual implementation.\end{DoxyRefDesc}


A default implementation allows one to readily use this feature by simply adding sequence motifs and corresponding binding free energies with the function \hyperlink{group__domains__up_gaec0c3313fb2951946614f920d289829a}{vrna\+\_\+ud\+\_\+add\+\_\+motif()} (see also \hyperlink{group__ligands__up}{Ligands binding to unstructured domains}).

The grammar extension is realized using a callback function that
\begin{DoxyItemize}
\item evaluates the binding free energy of a ligand to its target sequence segment (white boxes in the figures above), or
\item returns the free energy of an unpaired stretch possibly bound by a ligand, stored in the additional {\itshape U} DP matrix.
\end{DoxyItemize}

The callback is passed the segment positions, the loop context, and which of the two above mentioned evaluations are required. A second callback implements the pre-\/processing step that prepares the {\itshape U} DP matrix by evaluating all possible cases of the additional production rule. Both callbacks have a default implementation in {\itshape R\+N\+Alib}, but may be over-\/written by a user-\/implementation, making it fully user-\/customizable.

For equilibrium probability computations, two additional callbacks exist. One to store/add and one to retrieve the probability of unstructured domains at particular positions. Our implementation already takes care of computing the probabilities, but users of the unstructured domain feature are required to provide a mechanism to efficiently store/add the corresponding values into some external data structure. Collaboration diagram for Unstructured domains\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{group__domains__up}
\end{center}
\end{figure}
\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \hyperlink{unstructured__domains_8h}{unstructured\+\_\+domains.\+h}
\begin{DoxyCompactList}\small\item\em Functions to modify unstructured domains, e.\+g. to incorporate ligands binding to unpaired stretches. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{group__domains__up_structvrna__unstructured__domain__s}{vrna\+\_\+unstructured\+\_\+domain\+\_\+s}
\begin{DoxyCompactList}\small\item\em Data structure to store all functionality for ligand binding.  \hyperlink{group__domains__up_structvrna__unstructured__domain__s}{More...}\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group__domains__up_gaac911374e86236a51bfd42e1f098eaba}\label{group__domains__up_gaac911374e86236a51bfd42e1f098eaba}} 
\#define \hyperlink{group__domains__up_gaac911374e86236a51bfd42e1f098eaba}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+E\+X\+T\+\_\+\+L\+O\+OP}~1U
\begin{DoxyCompactList}\small\item\em Flag to indicate ligand bound to unpiared stretch in the exterior loop. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_ga23b610ea9564346c45cc1e2bbb62adf7}\label{group__domains__up_ga23b610ea9564346c45cc1e2bbb62adf7}} 
\#define \hyperlink{group__domains__up_ga23b610ea9564346c45cc1e2bbb62adf7}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+H\+P\+\_\+\+L\+O\+OP}~2U
\begin{DoxyCompactList}\small\item\em Flag to indicate ligand bound to unpaired stretch in a hairpin loop. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_gac4a0feccd9654c149203200248c2716b}\label{group__domains__up_gac4a0feccd9654c149203200248c2716b}} 
\#define \hyperlink{group__domains__up_gac4a0feccd9654c149203200248c2716b}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+I\+N\+T\+\_\+\+L\+O\+OP}~4U
\begin{DoxyCompactList}\small\item\em Flag to indicate ligand bound to unpiared stretch in an interior loop. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_ga67b80796655e5227a4ed662bfbe398b0}\label{group__domains__up_ga67b80796655e5227a4ed662bfbe398b0}} 
\#define \hyperlink{group__domains__up_ga67b80796655e5227a4ed662bfbe398b0}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+M\+B\+\_\+\+L\+O\+OP}~8U
\begin{DoxyCompactList}\small\item\em Flag to indicate ligand bound to unpiared stretch in a multibranch loop. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_gaab12b58d59be76446a9f76fad2fe624c}\label{group__domains__up_gaab12b58d59be76446a9f76fad2fe624c}} 
\#define \hyperlink{group__domains__up_gaab12b58d59be76446a9f76fad2fe624c}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+M\+O\+T\+IF}~16U
\begin{DoxyCompactList}\small\item\em Flag to indicate ligand binding without additional unbound nucleotides (motif-\/only) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_ga3c6be4cce70f1af9e885788856101699}\label{group__domains__up_ga3c6be4cce70f1af9e885788856101699}} 
\#define \hyperlink{group__domains__up_ga3c6be4cce70f1af9e885788856101699}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+A\+L\+L\+\_\+\+L\+O\+O\+PS}
\begin{DoxyCompactList}\small\item\em Flag to indicate ligand bound to unpiared stretch in any loop (convenience macro) \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group__domains__up_ga0009117b14d29143e8b18ab891f48c2d}\label{group__domains__up_ga0009117b14d29143e8b18ab891f48c2d}} 
typedef struct \hyperlink{group__domains__up_structvrna__unstructured__domain__s}{vrna\+\_\+unstructured\+\_\+domain\+\_\+s} \hyperlink{group__domains__up_ga0009117b14d29143e8b18ab891f48c2d}{vrna\+\_\+ud\+\_\+t}
\begin{DoxyCompactList}\small\item\em Typename for the ligand binding extension data structure \hyperlink{group__domains__up_structvrna__unstructured__domain__s}{vrna\+\_\+unstructured\+\_\+domain\+\_\+s}. \end{DoxyCompactList}\item 
typedef int() \hyperlink{group__domains__up_ga75825c57d0bfde4ae4f95c044260c5c3}{vrna\+\_\+callback\+\_\+ud\+\_\+energy}(\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int i, int j, unsigned int loop\+\_\+type, void $\ast$data)
\begin{DoxyCompactList}\small\item\em Callback to retrieve binding free energy of a ligand bound to an unpaired sequence segment. \end{DoxyCompactList}\item 
typedef \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL}() \hyperlink{group__domains__up_ga861706f257ba993753464b823e65b86e}{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+energy}(\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int i, int j, unsigned int loop\+\_\+type, void $\ast$data)
\begin{DoxyCompactList}\small\item\em Callback to retrieve Boltzmann factor of the binding free energy of a ligand bound to an unpaired sequence segment. \end{DoxyCompactList}\item 
typedef void() \hyperlink{group__domains__up_ga4fdfc02c1b660c07f2d887772f02a0a1}{vrna\+\_\+callback\+\_\+ud\+\_\+production}(\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, void $\ast$data)
\begin{DoxyCompactList}\small\item\em Callback for pre-\/processing the production rule of the ligand binding to unpaired stretches feature. \end{DoxyCompactList}\item 
typedef void() \hyperlink{group__domains__up_ga33d78327dcd04c1ca5ab2887edc18c7b}{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+production}(\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, void $\ast$data)
\begin{DoxyCompactList}\small\item\em Callback for pre-\/processing the production rule of the ligand binding to unpaired stretches feature (partition function variant) \end{DoxyCompactList}\item 
typedef void() \hyperlink{group__domains__up_gab10498abc84fcaf336aca8f8d7d42eb2}{vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+add}(\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int i, int j, unsigned int loop\+\_\+type, \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL} exp\+\_\+energy, void $\ast$data)
\begin{DoxyCompactList}\small\item\em Callback to store/add equilibrium probability for a ligand bound to an unpaired sequence segment. \end{DoxyCompactList}\item 
typedef \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL}() \hyperlink{group__domains__up_gaa10ba1b6f1e179ea84c5caca9cdaae67}{vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+get}(\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int i, int j, unsigned int loop\+\_\+type, int motif, void $\ast$data)
\begin{DoxyCompactList}\small\item\em Callback to retrieve equilibrium probability for a ligand bound to an unpaired sequence segment. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{group__domains__up_gaec0c3313fb2951946614f920d289829a}{vrna\+\_\+ud\+\_\+add\+\_\+motif} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, const char $\ast$motif, double motif\+\_\+en, unsigned int loop\+\_\+type)
\begin{DoxyCompactList}\small\item\em Add an unstructured domain motif, e.\+g. for ligand binding. \end{DoxyCompactList}\item 
void \hyperlink{group__domains__up_gada59cb0c498b812eadd010811af3f2d4}{vrna\+\_\+ud\+\_\+remove} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc)
\begin{DoxyCompactList}\small\item\em Remove ligand binding to unpaired stretches. \end{DoxyCompactList}\item 
void \hyperlink{group__domains__up_gac1f18c312b91d80089534a87d956e58b}{vrna\+\_\+ud\+\_\+set\+\_\+data} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, void $\ast$data, \hyperlink{group__fold__compound_ga7806651f51b195013839a218b3bbd5a3}{vrna\+\_\+callback\+\_\+free\+\_\+auxdata} $\ast$free\+\_\+cb)
\begin{DoxyCompactList}\small\item\em Attach an auxiliary data structure. \end{DoxyCompactList}\item 
void \hyperlink{group__domains__up_ga745a99f0bc72898d54de16f6e538828a}{vrna\+\_\+ud\+\_\+set\+\_\+prod\+\_\+rule\+\_\+cb} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, \hyperlink{group__domains__up_ga4fdfc02c1b660c07f2d887772f02a0a1}{vrna\+\_\+callback\+\_\+ud\+\_\+production} $\ast$pre\+\_\+cb, \hyperlink{group__domains__up_ga75825c57d0bfde4ae4f95c044260c5c3}{vrna\+\_\+callback\+\_\+ud\+\_\+energy} $\ast$e\+\_\+cb)
\begin{DoxyCompactList}\small\item\em Attach production rule callbacks for free energies computations. \end{DoxyCompactList}\item 
void \hyperlink{group__domains__up_ga2fb1db2099da26c76247e1209ad4aa09}{vrna\+\_\+ud\+\_\+set\+\_\+exp\+\_\+prod\+\_\+rule\+\_\+cb} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, \hyperlink{group__domains__up_ga33d78327dcd04c1ca5ab2887edc18c7b}{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+production} $\ast$pre\+\_\+cb, \hyperlink{group__domains__up_ga861706f257ba993753464b823e65b86e}{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+energy} $\ast$exp\+\_\+e\+\_\+cb)
\begin{DoxyCompactList}\small\item\em Attach production rule for partition function. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Data Structure Documentation}
\index{vrna\+\_\+unstructured\+\_\+domain\+\_\+s@{vrna\+\_\+unstructured\+\_\+domain\+\_\+s}}\label{structvrna__unstructured__domain__s}
\Hypertarget{group__domains__up_structvrna__unstructured__domain__s}
\subsubsection{struct vrna\+\_\+unstructured\+\_\+domain\+\_\+s}
Data structure to store all functionality for ligand binding. \subsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group__domains__up_ae17005ef8043aca2fc3864804cd5def6}\label{group__domains__up_ae17005ef8043aca2fc3864804cd5def6}} 
int \hyperlink{group__domains__up_ae17005ef8043aca2fc3864804cd5def6}{uniq\+\_\+motif\+\_\+count}
\begin{DoxyCompactList}\small\item\em The unique number of motifs of different lengths. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_a2b484b0e19a47145db7055ada8b14159}\label{group__domains__up_a2b484b0e19a47145db7055ada8b14159}} 
unsigned int $\ast$ \hyperlink{group__domains__up_a2b484b0e19a47145db7055ada8b14159}{uniq\+\_\+motif\+\_\+size}
\begin{DoxyCompactList}\small\item\em An array storing a unique list of motif lengths. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_a5ad34148ea1d2e501f3e02029449546e}\label{group__domains__up_a5ad34148ea1d2e501f3e02029449546e}} 
int \hyperlink{group__domains__up_a5ad34148ea1d2e501f3e02029449546e}{motif\+\_\+count}
\begin{DoxyCompactList}\small\item\em Total number of distinguished motifs. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_af285436bbdea4436ad2cedec65d48c75}\label{group__domains__up_af285436bbdea4436ad2cedec65d48c75}} 
char $\ast$$\ast$ \hyperlink{group__domains__up_af285436bbdea4436ad2cedec65d48c75}{motif}
\begin{DoxyCompactList}\small\item\em Motif sequences. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_a6a9f89ab7d147eb0ffd6cf8d77d178c0}\label{group__domains__up_a6a9f89ab7d147eb0ffd6cf8d77d178c0}} 
unsigned int $\ast$ \hyperlink{group__domains__up_a6a9f89ab7d147eb0ffd6cf8d77d178c0}{motif\+\_\+size}
\begin{DoxyCompactList}\small\item\em Motif lengths. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_aae4f0a45419784fb7c244bce2781403d}\label{group__domains__up_aae4f0a45419784fb7c244bce2781403d}} 
double $\ast$ \hyperlink{group__domains__up_aae4f0a45419784fb7c244bce2781403d}{motif\+\_\+en}
\begin{DoxyCompactList}\small\item\em Ligand binding free energy contribution. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_a3f0c026cced369ff176a66b2820f2057}\label{group__domains__up_a3f0c026cced369ff176a66b2820f2057}} 
unsigned int $\ast$ \hyperlink{group__domains__up_a3f0c026cced369ff176a66b2820f2057}{motif\+\_\+type}
\begin{DoxyCompactList}\small\item\em Type of motif, i.\+e. loop type the ligand binds to. \end{DoxyCompactList}\item 
\hyperlink{group__domains__up_ga4fdfc02c1b660c07f2d887772f02a0a1}{vrna\+\_\+callback\+\_\+ud\+\_\+production} $\ast$ \hyperlink{group__domains__up_ac2656d57130ac56e85212836482cbe80}{prod\+\_\+cb}
\begin{DoxyCompactList}\small\item\em Callback to ligand binding production rule, i.\+e. create/fill DP free energy matrices. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_a181ae6ec67f77e68899ec6a0780f3e01}\label{group__domains__up_a181ae6ec67f77e68899ec6a0780f3e01}} 
\hyperlink{group__domains__up_ga33d78327dcd04c1ca5ab2887edc18c7b}{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+production} $\ast$ \hyperlink{group__domains__up_a181ae6ec67f77e68899ec6a0780f3e01}{exp\+\_\+prod\+\_\+cb}
\begin{DoxyCompactList}\small\item\em Callback to ligand binding production rule, i.\+e. create/fill DP partition function matrices. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_a1efba765dd4ea893dc8bd7362761f99b}\label{group__domains__up_a1efba765dd4ea893dc8bd7362761f99b}} 
\hyperlink{group__domains__up_ga75825c57d0bfde4ae4f95c044260c5c3}{vrna\+\_\+callback\+\_\+ud\+\_\+energy} $\ast$ \hyperlink{group__domains__up_a1efba765dd4ea893dc8bd7362761f99b}{energy\+\_\+cb}
\begin{DoxyCompactList}\small\item\em Callback to evaluate free energy of ligand binding to a particular unpaired stretch. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_ad5aaa2530557880ae89e297f8f09aa55}\label{group__domains__up_ad5aaa2530557880ae89e297f8f09aa55}} 
\hyperlink{group__domains__up_ga861706f257ba993753464b823e65b86e}{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+energy} $\ast$ \hyperlink{group__domains__up_ad5aaa2530557880ae89e297f8f09aa55}{exp\+\_\+energy\+\_\+cb}
\begin{DoxyCompactList}\small\item\em Callback to evaluate Boltzmann factor of ligand binding to a particular unpaired stretch. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_a8802b1b0512999a9f35202031811ce17}\label{group__domains__up_a8802b1b0512999a9f35202031811ce17}} 
void $\ast$ \hyperlink{group__domains__up_a8802b1b0512999a9f35202031811ce17}{data}
\begin{DoxyCompactList}\small\item\em Auxiliary data structure passed to energy evaluation callbacks. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_a21b3084846902172858bc53f113d05a4}\label{group__domains__up_a21b3084846902172858bc53f113d05a4}} 
\hyperlink{group__fold__compound_ga7806651f51b195013839a218b3bbd5a3}{vrna\+\_\+callback\+\_\+free\+\_\+auxdata} $\ast$ \hyperlink{group__domains__up_a21b3084846902172858bc53f113d05a4}{free\+\_\+data}
\begin{DoxyCompactList}\small\item\em Callback to free auxiliary data structure. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_a457b43dfab7f4321b5d7a84e5deea5d7}\label{group__domains__up_a457b43dfab7f4321b5d7a84e5deea5d7}} 
\hyperlink{group__domains__up_gab10498abc84fcaf336aca8f8d7d42eb2}{vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+add} $\ast$ \hyperlink{group__domains__up_a457b43dfab7f4321b5d7a84e5deea5d7}{probs\+\_\+add}
\begin{DoxyCompactList}\small\item\em Callback to store/add outside partition function. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{group__domains__up_a0b155283bccf65c5253f31e0211ae8ff}\label{group__domains__up_a0b155283bccf65c5253f31e0211ae8ff}} 
\hyperlink{group__domains__up_gaa10ba1b6f1e179ea84c5caca9cdaae67}{vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+get} $\ast$ \hyperlink{group__domains__up_a0b155283bccf65c5253f31e0211ae8ff}{probs\+\_\+get}
\begin{DoxyCompactList}\small\item\em Callback to retrieve outside partition function. \end{DoxyCompactList}\end{DoxyCompactItemize}


\paragraph{Field Documentation}
\mbox{\Hypertarget{group__domains__up_ac2656d57130ac56e85212836482cbe80}\label{group__domains__up_ac2656d57130ac56e85212836482cbe80}} 
\index{vrna\+\_\+unstructured\+\_\+domain\+\_\+s@{vrna\+\_\+unstructured\+\_\+domain\+\_\+s}!prod\+\_\+cb@{prod\+\_\+cb}}
\index{prod\+\_\+cb@{prod\+\_\+cb}!vrna\+\_\+unstructured\+\_\+domain\+\_\+s@{vrna\+\_\+unstructured\+\_\+domain\+\_\+s}}
\subparagraph{\texorpdfstring{prod\+\_\+cb}{prod\_cb}}
{\footnotesize\ttfamily \hyperlink{group__domains__up_ga4fdfc02c1b660c07f2d887772f02a0a1}{vrna\+\_\+callback\+\_\+ud\+\_\+production}$\ast$ vrna\+\_\+unstructured\+\_\+domain\+\_\+s\+::prod\+\_\+cb}



Callback to ligand binding production rule, i.\+e. create/fill DP free energy matrices. 

This callback will be executed right before the actual secondary structure decompositions, and, therefore, any implementation must not interleave with the regular DP matrices. 

\subsection{Typedef Documentation}
\mbox{\Hypertarget{group__domains__up_ga75825c57d0bfde4ae4f95c044260c5c3}\label{group__domains__up_ga75825c57d0bfde4ae4f95c044260c5c3}} 
\index{Unstructured domains@{Unstructured domains}!vrna\+\_\+callback\+\_\+ud\+\_\+energy@{vrna\+\_\+callback\+\_\+ud\+\_\+energy}}
\index{vrna\+\_\+callback\+\_\+ud\+\_\+energy@{vrna\+\_\+callback\+\_\+ud\+\_\+energy}!Unstructured domains@{Unstructured domains}}
\subsubsection{\texorpdfstring{vrna\+\_\+callback\+\_\+ud\+\_\+energy}{vrna\_callback\_ud\_energy}}
{\footnotesize\ttfamily typedef int() vrna\+\_\+callback\+\_\+ud\+\_\+energy(\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int i, int j, unsigned int loop\+\_\+type, void $\ast$data)}



{\ttfamily \#include $<$\hyperlink{unstructured__domains_8h}{Vienna\+R\+N\+A/unstructured\+\_\+domains.\+h}$>$}



Callback to retrieve binding free energy of a ligand bound to an unpaired sequence segment. 

\begin{DoxyRefDesc}{Notes on Callback Functions}
\item[\hyperlink{callbacks__callbacks000010}{Notes on Callback Functions}]This function will be called to determine the additional energy contribution of a specific unstructured domain, e.\+g. the binding free energy of some ligand. \end{DoxyRefDesc}



\begin{DoxyParams}{Parameters}
{\em vc} & The current \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} \\
\hline
{\em i} & The start of the unstructured domain (5\textquotesingle{} end) \\
\hline
{\em j} & The end of the unstructured domain (3\textquotesingle{} end) \\
\hline
{\em loop\+\_\+type} & The loop context of the unstructured domain \\
\hline
{\em data} & Auxiliary data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The auxiliary energy contribution in deka-\/cal/mol 
\end{DoxyReturn}
\mbox{\Hypertarget{group__domains__up_ga861706f257ba993753464b823e65b86e}\label{group__domains__up_ga861706f257ba993753464b823e65b86e}} 
\index{Unstructured domains@{Unstructured domains}!vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+energy@{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+energy}}
\index{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+energy@{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+energy}!Unstructured domains@{Unstructured domains}}
\subsubsection{\texorpdfstring{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+energy}{vrna\_callback\_ud\_exp\_energy}}
{\footnotesize\ttfamily typedef \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL}() vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+energy(\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int i, int j, unsigned int loop\+\_\+type, void $\ast$data)}



{\ttfamily \#include $<$\hyperlink{unstructured__domains_8h}{Vienna\+R\+N\+A/unstructured\+\_\+domains.\+h}$>$}



Callback to retrieve Boltzmann factor of the binding free energy of a ligand bound to an unpaired sequence segment. 

\begin{DoxyRefDesc}{Notes on Callback Functions}
\item[\hyperlink{callbacks__callbacks000011}{Notes on Callback Functions}]This function will be called to determine the additional energy contribution of a specific unstructured domain, e.\+g. the binding free energy of some ligand (Partition function variant, i.\+e. the Boltzmann factors instead of actual free energies). \end{DoxyRefDesc}



\begin{DoxyParams}{Parameters}
{\em vc} & The current \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} \\
\hline
{\em i} & The start of the unstructured domain (5\textquotesingle{} end) \\
\hline
{\em j} & The end of the unstructured domain (3\textquotesingle{} end) \\
\hline
{\em loop\+\_\+type} & The loop context of the unstructured domain \\
\hline
{\em data} & Auxiliary data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The auxiliary energy contribution as Boltzmann factor 
\end{DoxyReturn}
\mbox{\Hypertarget{group__domains__up_ga4fdfc02c1b660c07f2d887772f02a0a1}\label{group__domains__up_ga4fdfc02c1b660c07f2d887772f02a0a1}} 
\index{Unstructured domains@{Unstructured domains}!vrna\+\_\+callback\+\_\+ud\+\_\+production@{vrna\+\_\+callback\+\_\+ud\+\_\+production}}
\index{vrna\+\_\+callback\+\_\+ud\+\_\+production@{vrna\+\_\+callback\+\_\+ud\+\_\+production}!Unstructured domains@{Unstructured domains}}
\subsubsection{\texorpdfstring{vrna\+\_\+callback\+\_\+ud\+\_\+production}{vrna\_callback\_ud\_production}}
{\footnotesize\ttfamily typedef void() vrna\+\_\+callback\+\_\+ud\+\_\+production(\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, void $\ast$data)}



{\ttfamily \#include $<$\hyperlink{unstructured__domains_8h}{Vienna\+R\+N\+A/unstructured\+\_\+domains.\+h}$>$}



Callback for pre-\/processing the production rule of the ligand binding to unpaired stretches feature. 

\begin{DoxyRefDesc}{Notes on Callback Functions}
\item[\hyperlink{callbacks__callbacks000012}{Notes on Callback Functions}]The production rule for the unstructured domain grammar extension \end{DoxyRefDesc}
\mbox{\Hypertarget{group__domains__up_ga33d78327dcd04c1ca5ab2887edc18c7b}\label{group__domains__up_ga33d78327dcd04c1ca5ab2887edc18c7b}} 
\index{Unstructured domains@{Unstructured domains}!vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+production@{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+production}}
\index{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+production@{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+production}!Unstructured domains@{Unstructured domains}}
\subsubsection{\texorpdfstring{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+production}{vrna\_callback\_ud\_exp\_production}}
{\footnotesize\ttfamily typedef void() vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+production(\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, void $\ast$data)}



{\ttfamily \#include $<$\hyperlink{unstructured__domains_8h}{Vienna\+R\+N\+A/unstructured\+\_\+domains.\+h}$>$}



Callback for pre-\/processing the production rule of the ligand binding to unpaired stretches feature (partition function variant) 

\begin{DoxyRefDesc}{Notes on Callback Functions}
\item[\hyperlink{callbacks__callbacks000013}{Notes on Callback Functions}]The production rule for the unstructured domain grammar extension (Partition function variant) \end{DoxyRefDesc}
\mbox{\Hypertarget{group__domains__up_gab10498abc84fcaf336aca8f8d7d42eb2}\label{group__domains__up_gab10498abc84fcaf336aca8f8d7d42eb2}} 
\index{Unstructured domains@{Unstructured domains}!vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+add@{vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+add}}
\index{vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+add@{vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+add}!Unstructured domains@{Unstructured domains}}
\subsubsection{\texorpdfstring{vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+add}{vrna\_callback\_ud\_probs\_add}}
{\footnotesize\ttfamily typedef void() vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+add(\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int i, int j, unsigned int loop\+\_\+type, \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL} exp\+\_\+energy, void $\ast$data)}



{\ttfamily \#include $<$\hyperlink{unstructured__domains_8h}{Vienna\+R\+N\+A/unstructured\+\_\+domains.\+h}$>$}



Callback to store/add equilibrium probability for a ligand bound to an unpaired sequence segment. 

\begin{DoxyRefDesc}{Notes on Callback Functions}
\item[\hyperlink{callbacks__callbacks000014}{Notes on Callback Functions}]A callback function to store equilibrium probabilities for the unstructured domain feature \end{DoxyRefDesc}
\mbox{\Hypertarget{group__domains__up_gaa10ba1b6f1e179ea84c5caca9cdaae67}\label{group__domains__up_gaa10ba1b6f1e179ea84c5caca9cdaae67}} 
\index{Unstructured domains@{Unstructured domains}!vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+get@{vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+get}}
\index{vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+get@{vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+get}!Unstructured domains@{Unstructured domains}}
\subsubsection{\texorpdfstring{vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+get}{vrna\_callback\_ud\_probs\_get}}
{\footnotesize\ttfamily typedef \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{F\+L\+T\+\_\+\+O\+R\+\_\+\+D\+BL}() vrna\+\_\+callback\+\_\+ud\+\_\+probs\+\_\+get(\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, int i, int j, unsigned int loop\+\_\+type, int motif, void $\ast$data)}



{\ttfamily \#include $<$\hyperlink{unstructured__domains_8h}{Vienna\+R\+N\+A/unstructured\+\_\+domains.\+h}$>$}



Callback to retrieve equilibrium probability for a ligand bound to an unpaired sequence segment. 

\begin{DoxyRefDesc}{Notes on Callback Functions}
\item[\hyperlink{callbacks__callbacks000015}{Notes on Callback Functions}]A callback function to retrieve equilibrium probabilities for the unstructured domain feature \end{DoxyRefDesc}


\subsection{Function Documentation}
\mbox{\Hypertarget{group__domains__up_gaec0c3313fb2951946614f920d289829a}\label{group__domains__up_gaec0c3313fb2951946614f920d289829a}} 
\index{Unstructured domains@{Unstructured domains}!vrna\+\_\+ud\+\_\+add\+\_\+motif@{vrna\+\_\+ud\+\_\+add\+\_\+motif}}
\index{vrna\+\_\+ud\+\_\+add\+\_\+motif@{vrna\+\_\+ud\+\_\+add\+\_\+motif}!Unstructured domains@{Unstructured domains}}
\subsubsection{\texorpdfstring{vrna\+\_\+ud\+\_\+add\+\_\+motif()}{vrna\_ud\_add\_motif()}}
{\footnotesize\ttfamily void vrna\+\_\+ud\+\_\+add\+\_\+motif (\begin{DoxyParamCaption}\item[{\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$}]{vc,  }\item[{const char $\ast$}]{motif,  }\item[{double}]{motif\+\_\+en,  }\item[{unsigned int}]{loop\+\_\+type }\end{DoxyParamCaption})}



{\ttfamily \#include $<$\hyperlink{unstructured__domains_8h}{Vienna\+R\+N\+A/unstructured\+\_\+domains.\+h}$>$}



Add an unstructured domain motif, e.\+g. for ligand binding. 

This function adds a ligand binding motif and the associated binding free energy to the \hyperlink{group__domains__up_ga0009117b14d29143e8b18ab891f48c2d}{vrna\+\_\+ud\+\_\+t} attribute of a \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t}. The motif data will then be used in subsequent secondary structure predictions. Multiple calls to this function with different motifs append all additional data to a list of ligands, which all will be evaluated. Ligand motif data can be removed from the \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} again using the \hyperlink{group__domains__up_gada59cb0c498b812eadd010811af3f2d4}{vrna\+\_\+ud\+\_\+remove()} function. The loop type parameter allows one to limit the ligand binding to particular loop type, such as the exterior loop, hairpin loops, interior loops, or multibranch loops.

\begin{DoxySeeAlso}{See also}
\hyperlink{group__domains__up_gaac911374e86236a51bfd42e1f098eaba}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+E\+X\+T\+\_\+\+L\+O\+OP}, \hyperlink{group__domains__up_ga23b610ea9564346c45cc1e2bbb62adf7}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+H\+P\+\_\+\+L\+O\+OP}, \hyperlink{group__domains__up_gac4a0feccd9654c149203200248c2716b}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+I\+N\+T\+\_\+\+L\+O\+OP}, \hyperlink{group__domains__up_ga67b80796655e5227a4ed662bfbe398b0}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+M\+B\+\_\+\+L\+O\+OP}, \hyperlink{group__domains__up_ga3c6be4cce70f1af9e885788856101699}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+A\+L\+L\+\_\+\+L\+O\+O\+PS}, \hyperlink{group__domains__up_gada59cb0c498b812eadd010811af3f2d4}{vrna\+\_\+ud\+\_\+remove()}
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em vc} & The \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} data structure the ligand motif should be bound to \\
\hline
{\em motif} & The sequence motif the ligand binds to \\
\hline
{\em motif\+\_\+en} & The binding free energy of the ligand in kcal/mol \\
\hline
{\em loop\+\_\+type} & The loop type the ligand binds to\\
\hline
\end{DoxyParams}
\begin{DoxyRefDesc}{S\+W\+I\+G Wrapper Notes}
\item[\hyperlink{wrappers__wrappers000068}{S\+W\+I\+G Wrapper Notes}]This function is attached as method {\bfseries ud\+\_\+add\+\_\+motif()} to objects of type {\itshape fold\+\_\+compound} \end{DoxyRefDesc}
\mbox{\Hypertarget{group__domains__up_gada59cb0c498b812eadd010811af3f2d4}\label{group__domains__up_gada59cb0c498b812eadd010811af3f2d4}} 
\index{Unstructured domains@{Unstructured domains}!vrna\+\_\+ud\+\_\+remove@{vrna\+\_\+ud\+\_\+remove}}
\index{vrna\+\_\+ud\+\_\+remove@{vrna\+\_\+ud\+\_\+remove}!Unstructured domains@{Unstructured domains}}
\subsubsection{\texorpdfstring{vrna\+\_\+ud\+\_\+remove()}{vrna\_ud\_remove()}}
{\footnotesize\ttfamily void vrna\+\_\+ud\+\_\+remove (\begin{DoxyParamCaption}\item[{\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$}]{vc }\end{DoxyParamCaption})}



{\ttfamily \#include $<$\hyperlink{unstructured__domains_8h}{Vienna\+R\+N\+A/unstructured\+\_\+domains.\+h}$>$}



Remove ligand binding to unpaired stretches. 

This function removes all ligand motifs that were bound to a \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} using the \hyperlink{group__domains__up_gaec0c3313fb2951946614f920d289829a}{vrna\+\_\+ud\+\_\+add\+\_\+motif()} function.


\begin{DoxyParams}{Parameters}
{\em vc} & The \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} data structure the ligand motif data should be removed from\\
\hline
\end{DoxyParams}
\begin{DoxyRefDesc}{S\+W\+I\+G Wrapper Notes}
\item[\hyperlink{wrappers__wrappers000069}{S\+W\+I\+G Wrapper Notes}]This function is attached as method {\bfseries ud\+\_\+remove()} to objects of type {\itshape fold\+\_\+compound} \end{DoxyRefDesc}
\mbox{\Hypertarget{group__domains__up_gac1f18c312b91d80089534a87d956e58b}\label{group__domains__up_gac1f18c312b91d80089534a87d956e58b}} 
\index{Unstructured domains@{Unstructured domains}!vrna\+\_\+ud\+\_\+set\+\_\+data@{vrna\+\_\+ud\+\_\+set\+\_\+data}}
\index{vrna\+\_\+ud\+\_\+set\+\_\+data@{vrna\+\_\+ud\+\_\+set\+\_\+data}!Unstructured domains@{Unstructured domains}}
\subsubsection{\texorpdfstring{vrna\+\_\+ud\+\_\+set\+\_\+data()}{vrna\_ud\_set\_data()}}
{\footnotesize\ttfamily void vrna\+\_\+ud\+\_\+set\+\_\+data (\begin{DoxyParamCaption}\item[{\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$}]{vc,  }\item[{void $\ast$}]{data,  }\item[{\hyperlink{group__fold__compound_ga7806651f51b195013839a218b3bbd5a3}{vrna\+\_\+callback\+\_\+free\+\_\+auxdata} $\ast$}]{free }\end{DoxyParamCaption})}



{\ttfamily \#include $<$\hyperlink{unstructured__domains_8h}{Vienna\+R\+N\+A/unstructured\+\_\+domains.\+h}$>$}



Attach an auxiliary data structure. 

This function binds an arbitrary, auxiliary data structure for user-\/implemented ligand binding. The optional callback {\ttfamily free} will be passed the bound data structure whenever the \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} is removed from memory to avoid memory leaks.

\begin{DoxySeeAlso}{See also}
\hyperlink{group__domains__up_ga745a99f0bc72898d54de16f6e538828a}{vrna\+\_\+ud\+\_\+set\+\_\+prod\+\_\+rule\+\_\+cb()}, \hyperlink{group__domains__up_ga2fb1db2099da26c76247e1209ad4aa09}{vrna\+\_\+ud\+\_\+set\+\_\+exp\+\_\+prod\+\_\+rule\+\_\+cb()}, \hyperlink{group__domains__up_gada59cb0c498b812eadd010811af3f2d4}{vrna\+\_\+ud\+\_\+remove()}
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em vc} & The \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} data structure the auxiliary data structure should be bound to \\
\hline
{\em data} & A pointer to the auxiliary data structure \\
\hline
{\em free\+\_\+cb} & A pointer to a callback function that free\textquotesingle{}s memory occupied by {\ttfamily data} \\
\hline
\end{DoxyParams}
\begin{DoxyRefDesc}{S\+W\+I\+G Wrapper Notes}
\item[\hyperlink{wrappers__wrappers000070}{S\+W\+I\+G Wrapper Notes}]This function is attached as method {\bfseries ud\+\_\+set\+\_\+data()} to objects of type {\itshape fold\+\_\+compound} \end{DoxyRefDesc}
\mbox{\Hypertarget{group__domains__up_ga745a99f0bc72898d54de16f6e538828a}\label{group__domains__up_ga745a99f0bc72898d54de16f6e538828a}} 
\index{Unstructured domains@{Unstructured domains}!vrna\+\_\+ud\+\_\+set\+\_\+prod\+\_\+rule\+\_\+cb@{vrna\+\_\+ud\+\_\+set\+\_\+prod\+\_\+rule\+\_\+cb}}
\index{vrna\+\_\+ud\+\_\+set\+\_\+prod\+\_\+rule\+\_\+cb@{vrna\+\_\+ud\+\_\+set\+\_\+prod\+\_\+rule\+\_\+cb}!Unstructured domains@{Unstructured domains}}
\subsubsection{\texorpdfstring{vrna\+\_\+ud\+\_\+set\+\_\+prod\+\_\+rule\+\_\+cb()}{vrna\_ud\_set\_prod\_rule\_cb()}}
{\footnotesize\ttfamily void vrna\+\_\+ud\+\_\+set\+\_\+prod\+\_\+rule\+\_\+cb (\begin{DoxyParamCaption}\item[{\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$}]{vc,  }\item[{\hyperlink{group__domains__up_ga4fdfc02c1b660c07f2d887772f02a0a1}{vrna\+\_\+callback\+\_\+ud\+\_\+production} $\ast$}]{pre\+\_\+cb,  }\item[{\hyperlink{group__domains__up_ga75825c57d0bfde4ae4f95c044260c5c3}{vrna\+\_\+callback\+\_\+ud\+\_\+energy} $\ast$}]{e\+\_\+cb }\end{DoxyParamCaption})}



{\ttfamily \#include $<$\hyperlink{unstructured__domains_8h}{Vienna\+R\+N\+A/unstructured\+\_\+domains.\+h}$>$}



Attach production rule callbacks for free energies computations. 

Use this function to bind a user-\/implemented grammar extension for unstructured domains.

The callback {\ttfamily e\+\_\+cb} needs to evaluate the free energy contribution $f(i,j)$ of the unpaired segment $[i,j]$. It will be executed in each of the regular secondary structure production rules. Whenever the callback is passed the \hyperlink{group__domains__up_gaab12b58d59be76446a9f76fad2fe624c}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+M\+O\+T\+IF} flag via its {\ttfamily loop\+\_\+type} parameter the contribution of any ligand that consecutively binds from position $i$ to $j$ (the white box) is requested. Otherwise, the callback usually performs a lookup in the precomputed {\ttfamily B} matrices. Which {\ttfamily B} matrix is addressed will be indicated by the flags \hyperlink{group__domains__up_gaac911374e86236a51bfd42e1f098eaba}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+E\+X\+T\+\_\+\+L\+O\+OP}, \hyperlink{group__domains__up_ga23b610ea9564346c45cc1e2bbb62adf7}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+H\+P\+\_\+\+L\+O\+OP} \hyperlink{group__domains__up_gac4a0feccd9654c149203200248c2716b}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+I\+N\+T\+\_\+\+L\+O\+OP}, and \hyperlink{group__domains__up_ga67b80796655e5227a4ed662bfbe398b0}{V\+R\+N\+A\+\_\+\+U\+N\+S\+T\+R\+U\+C\+T\+U\+R\+E\+D\+\_\+\+D\+O\+M\+A\+I\+N\+\_\+\+M\+B\+\_\+\+L\+O\+OP}. As their names already imply, they specify exterior loops ({\ttfamily F} production rule), hairpin loops and interior loops ({\ttfamily C} production rule), and multibranch loops ({\ttfamily M} and {\ttfamily M1} production rule).

 
\begin{DoxyImageNoCaption}
  \mbox{\includegraphics[width=\textwidth,height=\textheight/2,keepaspectratio=true]{ligands_up_callback}}
\end{DoxyImageNoCaption}


The {\ttfamily pre\+\_\+cb} callback will be executed as a pre-\/processing step right before the regular secondary structure rules. Usually one would use this callback to fill the dynamic programming matrices {\ttfamily U} and preparations of the auxiliary data structure \hyperlink{group__domains__up_a8802b1b0512999a9f35202031811ce17}{vrna\+\_\+unstructured\+\_\+domain\+\_\+s.\+data}

 
\begin{DoxyImageNoCaption}
  \mbox{\includegraphics[width=\textwidth,height=\textheight/2,keepaspectratio=true]{B_prod_rule}}
\end{DoxyImageNoCaption}



\begin{DoxyParams}{Parameters}
{\em vc} & The \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} data structure the callback will be bound to \\
\hline
{\em pre\+\_\+cb} & A pointer to a callback function for the {\ttfamily B} production rule \\
\hline
{\em e\+\_\+cb} & A pointer to a callback function for free energy evaluation\\
\hline
\end{DoxyParams}
\begin{DoxyRefDesc}{S\+W\+I\+G Wrapper Notes}
\item[\hyperlink{wrappers__wrappers000071}{S\+W\+I\+G Wrapper Notes}]This function is attached as method {\bfseries ud\+\_\+set\+\_\+prod\+\_\+rule\+\_\+cb()} to objects of type {\itshape fold\+\_\+compound} \end{DoxyRefDesc}
\mbox{\Hypertarget{group__domains__up_ga2fb1db2099da26c76247e1209ad4aa09}\label{group__domains__up_ga2fb1db2099da26c76247e1209ad4aa09}} 
\index{Unstructured domains@{Unstructured domains}!vrna\+\_\+ud\+\_\+set\+\_\+exp\+\_\+prod\+\_\+rule\+\_\+cb@{vrna\+\_\+ud\+\_\+set\+\_\+exp\+\_\+prod\+\_\+rule\+\_\+cb}}
\index{vrna\+\_\+ud\+\_\+set\+\_\+exp\+\_\+prod\+\_\+rule\+\_\+cb@{vrna\+\_\+ud\+\_\+set\+\_\+exp\+\_\+prod\+\_\+rule\+\_\+cb}!Unstructured domains@{Unstructured domains}}
\subsubsection{\texorpdfstring{vrna\+\_\+ud\+\_\+set\+\_\+exp\+\_\+prod\+\_\+rule\+\_\+cb()}{vrna\_ud\_set\_exp\_prod\_rule\_cb()}}
{\footnotesize\ttfamily void vrna\+\_\+ud\+\_\+set\+\_\+exp\+\_\+prod\+\_\+rule\+\_\+cb (\begin{DoxyParamCaption}\item[{\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$}]{vc,  }\item[{\hyperlink{group__domains__up_ga33d78327dcd04c1ca5ab2887edc18c7b}{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+production} $\ast$}]{pre\+\_\+cb,  }\item[{\hyperlink{group__domains__up_ga861706f257ba993753464b823e65b86e}{vrna\+\_\+callback\+\_\+ud\+\_\+exp\+\_\+energy} $\ast$}]{exp\+\_\+e\+\_\+cb }\end{DoxyParamCaption})}



{\ttfamily \#include $<$\hyperlink{unstructured__domains_8h}{Vienna\+R\+N\+A/unstructured\+\_\+domains.\+h}$>$}



Attach production rule for partition function. 

This function is the partition function companion of \hyperlink{group__domains__up_ga745a99f0bc72898d54de16f6e538828a}{vrna\+\_\+ud\+\_\+set\+\_\+prod\+\_\+rule\+\_\+cb()}.

Use it to bind callbacks to (i) fill the {\ttfamily U} production rule dynamic programming matrices and/or prepare the \hyperlink{group__domains__up_a8802b1b0512999a9f35202031811ce17}{vrna\+\_\+unstructured\+\_\+domain\+\_\+s.\+data}, and (ii) provide a callback to retrieve partition functions for subsegments $ [i,j] $.

 
\begin{DoxyImageNoCaption}
  \mbox{\includegraphics[width=\textwidth,height=\textheight/2,keepaspectratio=true]{B_prod_rule}}
\end{DoxyImageNoCaption}


 
\begin{DoxyImageNoCaption}
  \mbox{\includegraphics[width=\textwidth,height=\textheight/2,keepaspectratio=true]{ligands_up_callback}}
\end{DoxyImageNoCaption}


\begin{DoxySeeAlso}{See also}
\hyperlink{group__domains__up_ga745a99f0bc72898d54de16f6e538828a}{vrna\+\_\+ud\+\_\+set\+\_\+prod\+\_\+rule\+\_\+cb()}
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em vc} & The \hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} data structure the callback will be bound to \\
\hline
{\em pre\+\_\+cb} & A pointer to a callback function for the {\ttfamily B} production rule \\
\hline
{\em exp\+\_\+e\+\_\+cb} & A pointer to a callback function that retrieves the partition function for a segment $[i,j]$ that may be bound by one or more ligands.\\
\hline
\end{DoxyParams}
\begin{DoxyRefDesc}{S\+W\+I\+G Wrapper Notes}
\item[\hyperlink{wrappers__wrappers000072}{S\+W\+I\+G Wrapper Notes}]This function is attached as method {\bfseries ud\+\_\+set\+\_\+exp\+\_\+prod\+\_\+rule\+\_\+cb()} to objects of type {\itshape fold\+\_\+compound} \end{DoxyRefDesc}
