\hypertarget{multibranch__loops_8h_source}{}\section{multibranch\+\_\+loops.\+h}
\label{multibranch__loops_8h_source}\index{Vienna\+R\+N\+A/multibranch\+\_\+loops.\+h@{Vienna\+R\+N\+A/multibranch\+\_\+loops.\+h}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#ifndef VIENNA\_RNA\_PACKAGE\_MULTIBRANCH\_LOOPS\_H}
00002 \textcolor{preprocessor}{#define VIENNA\_RNA\_PACKAGE\_MULTIBRANCH\_LOOPS\_H}
00003 
00004 \textcolor{preprocessor}{#include <\hyperlink{utils_8h}{ViennaRNA/utils.h}>}
00005 \textcolor{preprocessor}{#include <\hyperlink{data__structures_8h}{ViennaRNA/data\_structures.h}>}
00006 \textcolor{preprocessor}{#include <\hyperlink{params_8h}{ViennaRNA/params.h}>}
00007 
00008 \textcolor{preprocessor}{#ifdef \_\_GNUC\_\_}
00009 \textcolor{preprocessor}{# define INLINE inline}
00010 \textcolor{preprocessor}{#else}
00011 \textcolor{preprocessor}{# define INLINE}
00012 \textcolor{preprocessor}{#endif}
00013 
\Hypertarget{multibranch__loops_8h_source_l00031}\hyperlink{group__loops}{00031} \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\{
00032   \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}  *qqm;
00033   \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}  *qqm1;
00034 
00035   \textcolor{keywordtype}{int}         qqmu\_size;
00036   \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}  **qqmu;
00037 \} \hyperlink{group__loops_structvrna__mx__pf__aux__ml__t}{vrna\_mx\_pf\_aux\_ml\_t};
00038 
00039 
00059 PRIVATE INLINE \textcolor{keywordtype}{int} E\_MLstem(\textcolor{keywordtype}{int}           type,
00060                             \textcolor{keywordtype}{int}           si1,
00061                             \textcolor{keywordtype}{int}           sj1,
00062                             \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t}  *P);
00063 
00064 
00071 PRIVATE INLINE \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL} exp\_E\_MLstem(\textcolor{keywordtype}{int}              type,
00072                                        \textcolor{keywordtype}{int}              si1,
00073                                        \textcolor{keywordtype}{int}              sj1,
00074                                        \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t} *P);
00075 
00076 
00082 \textcolor{keywordtype}{int} \hyperlink{group__loops_ga73f048d35475e1d8f50b7d4ac6a2aeb6}{vrna\_E\_mb\_loop\_stack}(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00083                          \textcolor{keywordtype}{int}                  i,
00084                          \textcolor{keywordtype}{int}                  j);
00085 
00086 
00102 \textcolor{keywordtype}{int}
00103 \hyperlink{group__loops_ga9cb520ddfd8b3a48089a7910b045d06b}{vrna\_BT\_mb\_loop}(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}  *vc,
00104                 \textcolor{keywordtype}{int}                   *i,
00105                 \textcolor{keywordtype}{int}                   *j,
00106                 \textcolor{keywordtype}{int}                   *k,
00107                 \textcolor{keywordtype}{int}                   en,
00108                 \textcolor{keywordtype}{int}                   *component1,
00109                 \textcolor{keywordtype}{int}                   *component2);
00110 
00111 
00112 \textcolor{keywordtype}{int}
00113 vrna\_E\_mb\_loop\_fast(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}  *vc,
00114                     \textcolor{keywordtype}{int}                   i,
00115                     \textcolor{keywordtype}{int}                   j,
00116                     \textcolor{keywordtype}{int}                   *dmli1,
00117                     \textcolor{keywordtype}{int}                   *dmli2);
00118 
00119 
00120 \textcolor{keywordtype}{int}
00121 \hyperlink{group__loops_ga73f048d35475e1d8f50b7d4ac6a2aeb6}{vrna\_E\_mb\_loop\_stack}(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00122                      \textcolor{keywordtype}{int}                  i,
00123                      \textcolor{keywordtype}{int}                  j);
00124 
00125 
00126 \textcolor{keywordtype}{int}
00127 E\_ml\_rightmost\_stem(\textcolor{keywordtype}{int}                   i,
00128                     \textcolor{keywordtype}{int}                   j,
00129                     \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}  *vc);
00130 
00131 
00132 \textcolor{keywordtype}{int}
00133 vrna\_E\_ml\_stems\_fast(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00134                      \textcolor{keywordtype}{int}                  i,
00135                      \textcolor{keywordtype}{int}                  j,
00136                      \textcolor{keywordtype}{int}                  *fmi,
00137                      \textcolor{keywordtype}{int}                  *dmli);
00138 
00139 
00140 \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}
00141 vrna\_exp\_E\_mb\_loop\_fast(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}  *vc,
00142                         \textcolor{keywordtype}{int}                   i,
00143                         \textcolor{keywordtype}{int}                   j,
00144                         \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}            *qqm1);
00145 
00146 
00147 \hyperlink{group__loops_structvrna__mx__pf__aux__ml__t}{vrna\_mx\_pf\_aux\_ml\_t} *
00148 vrna\_exp\_E\_ml\_fast\_init(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc);
00149 
00150 
00151 \textcolor{keywordtype}{void}
00152 vrna\_exp\_E\_ml\_fast\_rotate(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}  *vc,
00153                           \hyperlink{group__loops_structvrna__mx__pf__aux__ml__t}{vrna\_mx\_pf\_aux\_ml\_t}   *aux\_mx);
00154 
00155 
00156 \textcolor{keywordtype}{void}
00157 vrna\_exp\_E\_ml\_fast\_free(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}  *vc,
00158                         \hyperlink{group__loops_structvrna__mx__pf__aux__ml__t}{vrna\_mx\_pf\_aux\_ml\_t}   *aux\_mx);
00159 
00160 
00161 \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}
00162 vrna\_exp\_E\_ml\_fast(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00163                    \textcolor{keywordtype}{int}                  i,
00164                    \textcolor{keywordtype}{int}                  j,
00165                    \hyperlink{group__loops_structvrna__mx__pf__aux__ml__t}{vrna\_mx\_pf\_aux\_ml\_t}  *aux\_mx);
00166 
00167 
00168 \textcolor{comment}{/*}
00169 \textcolor{comment}{ #################################}
00170 \textcolor{comment}{ # Backtracking functions below  #}
00171 \textcolor{comment}{ #################################}
00172 \textcolor{comment}{ */}
00173 
00174 \textcolor{keywordtype}{int}
00175 vrna\_BT\_mb\_loop\_fake(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00176                      \textcolor{keywordtype}{int}                  *u,
00177                      \textcolor{keywordtype}{int}                  *i,
00178                      \textcolor{keywordtype}{int}                  *j,
00179                      \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t}      *bp\_stack,
00180                      \textcolor{keywordtype}{int}                  *stack\_count);
00181 
00182 
00183 \textcolor{keywordtype}{int}
00184 vrna\_BT\_mb\_loop\_split(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}  *vc,
00185                       \textcolor{keywordtype}{int}                   *i,
00186                       \textcolor{keywordtype}{int}                   *j,
00187                       \textcolor{keywordtype}{int}                   *k,
00188                       \textcolor{keywordtype}{int}                   *l,
00189                       \textcolor{keywordtype}{int}                   *component1,
00190                       \textcolor{keywordtype}{int}                   *component2,
00191                       \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t}       *bp\_stack,
00192                       \textcolor{keywordtype}{int}                   *stack\_count);
00193 
00194 
00195 \textcolor{keywordtype}{int}
00196 \hyperlink{group__loops_ga9cb520ddfd8b3a48089a7910b045d06b}{vrna\_BT\_mb\_loop}(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}  *vc,
00197                 \textcolor{keywordtype}{int}                   *i,
00198                 \textcolor{keywordtype}{int}                   *j,
00199                 \textcolor{keywordtype}{int}                   *k,
00200                 \textcolor{keywordtype}{int}                   en,
00201                 \textcolor{keywordtype}{int}                   *component1,
00202                 \textcolor{keywordtype}{int}                   *component2);
00203 
00204 
00205 \textcolor{comment}{/*}
00206 \textcolor{comment}{ ########################################}
00207 \textcolor{comment}{ # BEGIN OF INLINE FUNCTION DEFINITIONS #}
00208 \textcolor{comment}{ ########################################}
00209 \textcolor{comment}{ */}
00210 PRIVATE INLINE \textcolor{keywordtype}{int}
00211 E\_MLstem(\textcolor{keywordtype}{int}          type,
00212          \textcolor{keywordtype}{int}          si1,
00213          \textcolor{keywordtype}{int}          sj1,
00214          \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P)
00215 \{
00216   \textcolor{keywordtype}{int} energy = 0;
00217 
00218   \textcolor{keywordflow}{if} (si1 >= 0 && sj1 >= 0)
00219     energy += P->mismatchM[type][si1][sj1];
00220   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (si1 >= 0)
00221     energy += P->dangle5[type][si1];
00222   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sj1 >= 0)
00223     energy += P->dangle3[type][sj1];
00224 
00225   \textcolor{keywordflow}{if} (type > 2)
00226     energy += P->TerminalAU;
00227 
00228   energy += P->MLintern[type];
00229 
00230   \textcolor{keywordflow}{return} energy;
00231 \}
00232 
00233 
00234 PRIVATE INLINE \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}
00235 exp\_E\_MLstem(\textcolor{keywordtype}{int}              type,
00236              \textcolor{keywordtype}{int}              si1,
00237              \textcolor{keywordtype}{int}              sj1,
00238              \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t} *P)
00239 \{
00240   \textcolor{keywordtype}{double} energy = 1.0;
00241 
00242   \textcolor{keywordflow}{if} (si1 >= 0 && sj1 >= 0)
00243     energy = P->expmismatchM[type][si1][sj1];
00244   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (si1 >= 0)
00245     energy = P->expdangle5[type][si1];
00246   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sj1 >= 0)
00247     energy = P->expdangle3[type][sj1];
00248 
00249   \textcolor{keywordflow}{if} (type > 2)
00250     energy *= P->expTermAU;
00251 
00252   energy *= P->expMLintern[type];
00253   \textcolor{keywordflow}{return} (\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL})energy;
00254 \}
00255 
00256 
00261 \textcolor{preprocessor}{#endif}
\end{DoxyCode}
