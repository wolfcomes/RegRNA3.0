\hypertarget{structure__utils_8h_source}{}\section{structure\+\_\+utils.\+h}
\label{structure__utils_8h_source}\index{Vienna\+R\+N\+A/structure\+\_\+utils.\+h@{Vienna\+R\+N\+A/structure\+\_\+utils.\+h}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#ifndef VIENNA\_RNA\_PACKAGE\_STRUCT\_UTILS\_H}
00002 \textcolor{preprocessor}{#define VIENNA\_RNA\_PACKAGE\_STRUCT\_UTILS\_H}
00003 
00004 \textcolor{preprocessor}{#ifdef VRNA\_WARN\_DEPRECATED}
00005 \textcolor{preprocessor}{# if defined(\_\_clang\_\_)}
00006 \textcolor{preprocessor}{#  define DEPRECATED(func, msg) func \_\_attribute\_\_ ((deprecated("", msg)))}
00007 \textcolor{preprocessor}{# elif defined(\_\_GNUC\_\_)}
00008 \textcolor{preprocessor}{#  define DEPRECATED(func, msg) func \_\_attribute\_\_ ((deprecated(msg)))}
00009 \textcolor{preprocessor}{# else}
00010 \textcolor{preprocessor}{#  define DEPRECATED(func, msg) func}
00011 \textcolor{preprocessor}{# endif}
00012 \textcolor{preprocessor}{#else}
00013 \textcolor{preprocessor}{# define DEPRECATED(func, msg) func}
00014 \textcolor{preprocessor}{#endif}
00015 
00027 \textcolor{preprocessor}{#define VRNA\_PLIST\_TYPE\_BASEPAIR      0}
00028 \textcolor{preprocessor}{#define VRNA\_PLIST\_TYPE\_GQUAD         1}
00029 \textcolor{preprocessor}{#define VRNA\_PLIST\_TYPE\_H\_MOTIF       2}
00030 \textcolor{preprocessor}{#define VRNA\_PLIST\_TYPE\_I\_MOTIF       3}
00031 \textcolor{preprocessor}{#define VRNA\_PLIST\_TYPE\_UD\_MOTIF      4}
00032 \textcolor{preprocessor}{#define VRNA\_PLIST\_TYPE\_STACK         5}
00033 
\Hypertarget{structure__utils_8h_source_l00039}\hyperlink{group__struct__utils_ga7e3f630af8d69bb0e917145aacf2f96d}{00039} \textcolor{preprocessor}{#define VRNA\_BRACKETS\_ALPHA    4U}
00040 
\Hypertarget{structure__utils_8h_source_l00046}\hyperlink{group__struct__utils_gac92d5fa7c6625bce2670ece510a24fbd}{00046} \textcolor{preprocessor}{#define VRNA\_BRACKETS\_RND      8U}
00047 
\Hypertarget{structure__utils_8h_source_l00053}\hyperlink{group__struct__utils_gaf41be40e79cb756c4e0bb8edb4d803d2}{00053} \textcolor{preprocessor}{#define VRNA\_BRACKETS\_CLY      16U}
00054 
\Hypertarget{structure__utils_8h_source_l00060}\hyperlink{group__struct__utils_ga863e03f7f73f10fc9bbcbefbdda4bec8}{00060} \textcolor{preprocessor}{#define VRNA\_BRACKETS\_ANG      32U}
00061 
\Hypertarget{structure__utils_8h_source_l00067}\hyperlink{group__struct__utils_ga60525d61d7496eeea490a37f3d6bf757}{00067} \textcolor{preprocessor}{#define VRNA\_BRACKETS\_SQR      64U}
00068 
\Hypertarget{structure__utils_8h_source_l00074}\hyperlink{group__struct__utils_ga559ebf76b1b289f85309f4206e99aa1a}{00074} \textcolor{preprocessor}{#define VRNA\_BRACKETS\_DEFAULT  \(\backslash\)}
00075 \textcolor{preprocessor}{  (VRNA\_BRACKETS\_RND | \(\backslash\)}
00076 \textcolor{preprocessor}{   VRNA\_BRACKETS\_CLY | \(\backslash\)}
00077 \textcolor{preprocessor}{   VRNA\_BRACKETS\_ANG | \(\backslash\)}
00078 \textcolor{preprocessor}{   VRNA\_BRACKETS\_SQR)}
00079 
00080 
\Hypertarget{structure__utils_8h_source_l00084}\hyperlink{group__struct__utils_ga877363f3a1703b53ecd025c6fcf897a0}{00084} \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\hyperlink{group__struct__utils_structvrna__hx__s}{vrna\_hx\_s} \hyperlink{group__struct__utils_structvrna__hx__s}{vrna\_hx\_t};
00085 
\Hypertarget{structure__utils_8h_source_l00089}\hyperlink{group__struct__utils_gab9ac98ab55ded9fb90043b024b915aca}{00089} \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\hyperlink{group__struct__utils_structvrna__elem__prob__s}{vrna\_elem\_prob\_s} \hyperlink{group__struct__utils_structvrna__elem__prob__s}{vrna\_ep\_t};
00090 
00091 \textcolor{preprocessor}{#include <stdio.h>}
00092 
00093 \textcolor{preprocessor}{#include <\hyperlink{data__structures_8h}{ViennaRNA/data\_structures.h}>}
00094 
\Hypertarget{structure__utils_8h_source_l00098}\hyperlink{group__struct__utils}{00098} \textcolor{keyword}{struct }\hyperlink{group__struct__utils_structvrna__hx__s}{vrna\_hx\_s} \{
00099   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  start;
00100   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  end;
00101   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  length;
00102   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  up5;
00103   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  up3;
00104 \};
00105 
\Hypertarget{structure__utils_8h_source_l00114}\hyperlink{group__struct__utils}{00114} \textcolor{keyword}{struct }\hyperlink{group__struct__utils_structvrna__elem__prob__s}{vrna\_elem\_prob\_s} \{
00115   \textcolor{keywordtype}{int}   i;
00116   \textcolor{keywordtype}{int}   j;
00117   \textcolor{keywordtype}{float} p;
00118   \textcolor{keywordtype}{int}   type;
00119 \};
00120 
00133 \textcolor{keywordtype}{char} *\hyperlink{group__struct__utils_ga55c4783060a1464f862f858d5599c9e1}{vrna\_db\_pack}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *struc);
00134 
00135 
00146 \textcolor{keywordtype}{char} *\hyperlink{group__struct__utils_ga6490adff857d84ce06e6f379ae3a4512}{vrna\_db\_unpack}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *packed);
00147 
00148 
00160 \textcolor{keywordtype}{short} *\hyperlink{group__struct__utils_gae829fb8bb7f694c12a9c0bbc34c77c60}{vrna\_ptable}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *structure);
00161 
00162 
00178 \textcolor{keywordtype}{short} *
00179 \hyperlink{group__struct__utils_gac76c9ef3de507748fb0416a59323362b}{vrna\_ptable\_from\_string}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}    *\textcolor{keywordtype}{string},
00180                         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  options);
00181 
00182 
00195 \textcolor{keywordtype}{short} *\hyperlink{group__struct__utils_gacca520048b24ec5a8978f4dafb4e4bf8}{vrna\_pt\_pk\_get}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *structure);
00196 
00197 
00204 \textcolor{keywordtype}{short} *\hyperlink{group__struct__utils_ga2daefbbd6d9f8803731651882f54332d}{vrna\_ptable\_copy}(\textcolor{keyword}{const} \textcolor{keywordtype}{short} *pt);
00205 
00206 
00211 \textcolor{keywordtype}{short} *\hyperlink{group__struct__utils_ga1ee4cdcda1f57d32dcb38032116d335d}{vrna\_pt\_ali\_get}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *structure);
00212 
00213 
00221 \textcolor{keywordtype}{short} *\hyperlink{group__struct__utils_gaef0f7e1a6c00c81a349973de53039dda}{vrna\_pt\_snoop\_get}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *structure);
00222 
00223 
00227 \textcolor{keywordtype}{int} *\hyperlink{group__struct__utils_ga03e15af299be0866ff21da880c74b92e}{vrna\_loopidx\_from\_ptable}(\textcolor{keyword}{const} \textcolor{keywordtype}{short} *pt);
00228 
00229 
00245 \textcolor{keywordtype}{void}
00246 \hyperlink{group__struct__utils_gae966b9f44168a4f4b39ca42ffb5f37b7}{vrna\_db\_flatten}(\textcolor{keywordtype}{char}          *structure,
00247                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  options);
00248 
00249 
00269 \textcolor{keywordtype}{void}
00270 \hyperlink{group__struct__utils_ga690425199c8b71545e7196e3af1436f8}{vrna\_db\_flatten\_to}(\textcolor{keywordtype}{char}         *\textcolor{keywordtype}{string},
00271                    \textcolor{keyword}{const} \textcolor{keywordtype}{char}   target[3],
00272                    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} options);
00273 
00274 
00281 \textcolor{keywordtype}{char} *\hyperlink{group__struct__utils_gaf9ecd0d7877fecdbb0292e24f40283d5}{vrna\_db\_from\_ptable}(\textcolor{keywordtype}{short} *pt);
00282 
00283 
00295 \textcolor{keywordtype}{char} *\hyperlink{group__struct__utils_ga02ca70cffb2d864f7b2d95d92218bae0}{vrna\_db\_from\_WUSS}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *wuss);
00296 
00297 
00309 \textcolor{keywordtype}{int} \hyperlink{group__struct__utils_ga65bdfbac6a16bf30286e8a3f7d15f60a}{vrna\_bp\_distance}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *str1,
00310                      \textcolor{keyword}{const} \textcolor{keywordtype}{char} *str2);
00311 
00312 
00319 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *\hyperlink{group__struct__utils_gab4c2a00c99ce1d612ffa5bde114eb96d}{vrna\_refBPcnt\_matrix}(\textcolor{keyword}{const} \textcolor{keywordtype}{short}  *reference\_pt,
00320                                    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} turn);
00321 
00322 
00330 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *\hyperlink{group__struct__utils_ga5a27bd058183170afd4716f5b8ff511a}{vrna\_refBPdist\_matrix}(\textcolor{keyword}{const} \textcolor{keywordtype}{short}   *pt1,
00331                                     \textcolor{keyword}{const} \textcolor{keywordtype}{short}   *pt2,
00332                                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  turn);
00333 
00334 
00338 \textcolor{keywordtype}{char} *\hyperlink{group__struct__utils_ga0c28c410a5ab22d6ab9c77a84e8d5b44}{vrna\_db\_from\_probs}(\textcolor{keyword}{const} \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL} *\hyperlink{fold__vars_8h_ac98ec419070aee6831b44e5c700f090f}{pr},
00339                          \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}     length);
00340 
00341 
00345 \textcolor{keywordtype}{char} \hyperlink{group__struct__utils_ga025bff1b27fa46534c8fae6980f64bb5}{vrna\_bpp\_symbol}(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *x);
00346 
00347 
00359 \textcolor{keywordtype}{char} *\hyperlink{group__struct__utils_ga27bea2c241564af53a065982183389df}{vrna\_db\_from\_bp\_stack}(\hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t} *bp,
00360                             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    length);
00361 
00362 
00363 \textcolor{keywordtype}{void} vrna\_letter\_structure(\textcolor{keywordtype}{char}             *structure,
00364                            \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t}  *bp,
00365                            \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}     length);
00366 
00367 
00383 \hyperlink{group__struct__utils_structvrna__elem__prob__s}{vrna\_ep\_t} *\hyperlink{group__struct__utils_gaf002d69024d709744664a8b9ca3dd77d}{vrna\_plist}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}  *struc,
00384                       \textcolor{keywordtype}{float}       \hyperlink{fold__vars_8h_ac98ec419070aee6831b44e5c700f090f}{pr});
00385 
00386 
00403 \hyperlink{group__struct__utils_structvrna__elem__prob__s}{vrna\_ep\_t} *\hyperlink{group__pf__fold_ga94f6efc0b8d8712b023452794a0a5bd2}{vrna\_plist\_from\_probs}(
      \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00404                                  \textcolor{keywordtype}{double}               cut\_off);
00405 
00406 
00416 \textcolor{keywordtype}{char} *\hyperlink{group__struct__utils_ga6a51a36b9245d0bac868c5cd172b9611}{vrna\_db\_from\_plist}(\hyperlink{group__struct__utils_structvrna__elem__prob__s}{vrna\_ep\_t}    *\hyperlink{group__struct__utils_ga6341cbb704924824e0236c1dce791032}{pairs},
00417                          \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} n);
00418 
00419 
00420 \textcolor{keywordtype}{char} *vrna\_db\_to\_element\_string(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *structure);
00421 
00422 
00423 \hyperlink{group__struct__utils_structvrna__hx__s}{vrna\_hx\_t} *vrna\_hx\_from\_ptable(\textcolor{keywordtype}{short} *pt);
00424 
00425 
00426 \hyperlink{group__struct__utils_structvrna__hx__s}{vrna\_hx\_t} *vrna\_hx\_merge(\textcolor{keyword}{const} \hyperlink{group__struct__utils_structvrna__hx__s}{vrna\_hx\_t}  *list,
00427                          \textcolor{keywordtype}{int}              maxdist);
00428 
00429 
00430 \textcolor{preprocessor}{#ifndef VRNA\_DISABLE\_BACKWARD\_COMPATIBILITY}
00431 
00432 \textcolor{comment}{/*###########################################*/}
00433 \textcolor{comment}{/*# deprecated functions below              #*/}
00434 \textcolor{comment}{/*###########################################*/}
00435 
00453 DEPRECATED(\textcolor{keywordtype}{void} \hyperlink{group__struct__utils_gab61df77cf7949cd516181fce0c3d7d78}{assign\_plist\_from\_db}(\hyperlink{group__struct__utils_structvrna__elem__prob__s}{vrna\_ep\_t}  **pl,
00454                                      \textcolor{keyword}{const} \textcolor{keywordtype}{char} *struc,
00455                                      \textcolor{keywordtype}{float}      \hyperlink{fold__vars_8h_ac98ec419070aee6831b44e5c700f090f}{pr}),
00456 \textcolor{stringliteral}{"Use vrna\_plist() instead"});
00457 
00470 DEPRECATED(\textcolor{keywordtype}{char} *\hyperlink{group__struct__utils_gac6dfa5e22928c087c6e09ff0054a7ced}{pack\_structure}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *struc),
00471 \textcolor{stringliteral}{"Use vrna\_db\_pack() instead"});
00472 
00483 DEPRECATED(\textcolor{keywordtype}{char} *\hyperlink{group__struct__utils_ga071c6921efe1eb974f115ee6fefa3c39}{unpack\_structure}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *packed),
00484 \textcolor{stringliteral}{"Use vrna\_db\_unpack() instead"});
00485 
00497 DEPRECATED(\textcolor{keywordtype}{short} *\hyperlink{group__struct__utils_ga89c32307ee50a0026f4a3131fac0845a}{make\_pair\_table}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *structure),
00498 \textcolor{stringliteral}{"Use vrna\_ptable() instead"});
00499 
00500 DEPRECATED(\textcolor{keywordtype}{short} *make\_pair\_table\_pk(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *structure),
00501 \textcolor{stringliteral}{"Use vrna\_ptable\_from\_string() instead"});
00502 
00511 DEPRECATED(\textcolor{keywordtype}{short} *\hyperlink{group__struct__utils_gafeaa6d68eef3a99d0a7aa08aa91c6601}{copy\_pair\_table}(\textcolor{keyword}{const} \textcolor{keywordtype}{short} *pt),
00512 \textcolor{stringliteral}{"Use vrna\_ptable\_copy() instead"});
00513 
00519 DEPRECATED(\textcolor{keywordtype}{short} *\hyperlink{group__struct__utils_ga3c81b3967056c3888b8472b65fbb16f5}{alimake\_pair\_table}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *structure),
00520 \textcolor{stringliteral}{"Use vrna\_pt\_ali\_get() instead"});
00521 
00528 DEPRECATED(\textcolor{keywordtype}{short} *\hyperlink{group__struct__utils_ga9aa3bf3b4346bb7fb88efc154dd07a79}{make\_pair\_table\_snoop}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *structure),
00529 \textcolor{stringliteral}{"Use vrna\_pt\_snoop\_get() instead"});
00530 
00531 DEPRECATED(\textcolor{keywordtype}{int} *make\_loop\_index\_pt(\textcolor{keywordtype}{short} *pt),
00532 \textcolor{stringliteral}{"Use vrna\_loopidx\_from\_ptable() instead"});
00533 
00546 DEPRECATED(\textcolor{keywordtype}{int} \hyperlink{group__struct__utils_ga6ebbcd29a754f0e4f1a66d1fd84184db}{bp\_distance}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *str1,
00547                            \textcolor{keyword}{const} \textcolor{keywordtype}{char} *str2),
00548 \textcolor{stringliteral}{"Use vrna\_bp\_distance() instead"});
00549 
00558 DEPRECATED(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *\hyperlink{group__struct__utils_ga578cd9712dee812fb1c58aa3cc489864}{make\_referenceBP\_array}(\textcolor{keywordtype}{short}         *reference\_pt,
00559                                                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}  turn),
00560 \textcolor{stringliteral}{"Use vrna\_refBPcnt\_matrix() instead"});
00561 
00570 DEPRECATED(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *\hyperlink{group__struct__utils_gadd463184355d0803b6ee6e09f29182f2}{compute\_BPdifferences}(\textcolor{keywordtype}{short}        *pt1,
00571                                                \textcolor{keywordtype}{short}        *pt2,
00572                                                \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} turn),
00573 \textcolor{stringliteral}{"Use vrna\_refBPdist\_matrix() instead"});
00574 
00594 DEPRECATED(\textcolor{keywordtype}{void}  \hyperlink{group__pf__fold_ga1cc05aaa9b0e7df2d3887e98321c2030}{assign\_plist\_from\_pr}(\hyperlink{group__struct__utils_structvrna__elem__prob__s}{vrna\_ep\_t}   **pl,
00595                                       \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}  *probs,
00596                                       \textcolor{keywordtype}{int}         length,
00597                                       \textcolor{keywordtype}{double}      cutoff),
00598 \textcolor{stringliteral}{"Use vrna\_plist\_from\_probs() instead"});
00599 
00607 DEPRECATED(\textcolor{keywordtype}{void} \hyperlink{group__struct__utils_gadf0ad2d46c9ca7b850437d1b79627a7e}{parenthesis\_structure}(\textcolor{keywordtype}{char}            *structure,
00608                                       \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t} *bp,
00609                                       \textcolor{keywordtype}{int}             length),
00610 \textcolor{stringliteral}{"Use vrna\_parenthesis\_structure() instead"});
00611 
00620 DEPRECATED(\textcolor{keywordtype}{void} \hyperlink{group__struct__utils_gab9c5c8311bd5120900585d4fa50c2df0}{parenthesis\_zuker}(\textcolor{keywordtype}{char}            *structure,
00621                                   \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t} *bp,
00622                                   \textcolor{keywordtype}{int}             length),
00623 \textcolor{stringliteral}{"Use vrna\_parenthesis\_zuker() instead"});
00624 
00625 DEPRECATED(\textcolor{keywordtype}{void} letter\_structure(\textcolor{keywordtype}{char}             *structure,
00626                                  \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t}  *bp,
00627                                  \textcolor{keywordtype}{int}              length),
00628 \textcolor{stringliteral}{"Use vrna\_letter\_structure() instead"});
00629 
00634 DEPRECATED(\textcolor{keywordtype}{void}  \hyperlink{group__struct__utils_ga129d81c4a1ead793c5b2311333e03dfa}{bppm\_to\_structure}(\textcolor{keywordtype}{char}         *structure,
00635                                    \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}   *\hyperlink{fold__vars_8h_ac98ec419070aee6831b44e5c700f090f}{pr},
00636                                    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} length),
00637 \textcolor{stringliteral}{"Use vrna\_db\_from\_probs() instead"});
00638 
00643 DEPRECATED(\textcolor{keywordtype}{char}    \hyperlink{group__struct__utils_ga49962ad6242b8c628de6ca16bb831c1d}{bppm\_symbol}(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *x),
00644 \textcolor{stringliteral}{"Use vrna\_bpp\_symbol() instead"});
00645 
00646 \textcolor{preprocessor}{#endif}
00647 
00652 \textcolor{preprocessor}{#endif}
\end{DoxyCode}
